import { createClient } from '@supabase/supabase-js'

const supabaseUrl = 'https://vvxpqdxmoapmceaggikl.supabase.co'
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2eHBxZHhtb2FwbWNlYWdnaWtsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0NTgwODUsImV4cCI6MjA3MzAzNDA4NX0.tpCp1XxwzGZAt6aQPQnkyFbC4x5SGs1_2Y59VzOU1aQ'

const supabase = createClient(supabaseUrl, supabaseKey)

async function testConnection() {
  console.log('üîç Testing Supabase connection...')
  
  try {
    // Test 1: Check categories
    console.log('\nüìÇ Testing categories...')
    const { data: expenseCategories, error: expenseError } = await supabase
      .from('categories_output')
      .select('*')
      .limit(3)
    
    if (expenseError) {
      console.error('‚ùå Error fetching expense categories:', expenseError)
    } else {
      console.log('‚úÖ Expense categories:', expenseCategories)
    }

    const { data: incomeCategories, error: incomeError } = await supabase
      .from('categories_input')
      .select('*')
      .limit(3)
    
    if (incomeError) {
      console.error('‚ùå Error fetching income categories:', incomeError)
    } else {
      console.log('‚úÖ Income categories:', incomeCategories)
    }

    // Test 2: Check auth
    console.log('\nüîê Testing auth...')
    const { data: { user }, error: authError } = await supabase.auth.getUser()
    
    if (authError) {
      console.log('‚ÑπÔ∏è No authenticated user (expected if not logged in)')
    } else if (user) {
      console.log('‚úÖ Current user:', user.email)
      
      // Test 3: Check user profile
      const { data: profile, error: profileError } = await supabase
        .from('users')
        .select('*')
        .eq('id', user.id)
        .single()
      
      if (profileError) {
        console.error('‚ùå Error fetching user profile:', profileError)
      } else {
        console.log('‚úÖ User profile:', profile)
      }
    } else {
      console.log('‚ÑπÔ∏è No user logged in')
    }

  } catch (error) {
    console.error('‚ùå Connection test failed:', error)
  }
}

testConnection()
